<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0"/>
<link href="css/bootstrap.min.css" type="text/css" rel="stylesheet"/>
<link href="css/common.css" type="text/css" rel="stylesheet"/>
<link href="css/style.css" type="text/css" rel="stylesheet"/>
<link href="js/select2/select2.css" type="text/css" rel="stylesheet" />
<link href="css/easyui.css" type="text/css" rel="stylesheet" />
<link href="css/icon.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery-1.9.0.js"></script>
<script type="text/javascript" src="js/select2/select2.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script> 
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/jquery.easyui.min.js"></script>
<!--[if IE]><script type="text/javascript" src="js/html5.js"></script><![endif]-->
<script>
	$(function(){
		//下拉框
		$(".select").select2();	
		
		//新增
		$("#add").click(function(){
			layer.open({
				type: 2, 
				content: 'addUserInfo.html',
				title : '新增',
				border : [0],
				area : ['620px' , '325px'],	
			});
		})
		
		//编辑
		$("#edit").click(function(){
			layer.open({
				type:2, 
				content:'editUserInfo.html',
				title : '编辑',
				border : [0],
				area : ['620px' , '325px'],
			});
		})
	
		//查询
		$("#search").click(function(){
			var username = $("#username").val(); //获取用户名称
			var phone = $("#phone").val(); //获取用户手机号
			var companyName =$("#companyName").val();//获取公司名称
			$("#dg").datagrid('load',{
				username:username	,
				phone:phone,
				companyName:companyName
			})
			$('#dg').datagrid('reload');    // reload the current page data			
		})
		
		//

		/*  $("#pus").click(function(){
			
			$.ajax({
				type : 'GET',
			 	url:'/caocao/usermanage/query.do?pageIndex=1&pageSize=2&username=&phone=&companyName=',
				async : false,
				dataType : 'json',
				beforeSend : function(jqXHR) {
				jqXHR.setRequestHeader('Authorization', 'Bearer '
				+ '3feee5b76d8e698f4e5e29c626eb9dc2');
				},
				success : function(data) {
				for ( var machine in data) {
					
					var a = [ {
						'id' : data[machine].id,
						'username' : data[machine].username,
						'phone' : data[machine].phone,
						'post' : data[machine].post,
						'isactive' : data[machine].isactive,
						'isactivetime' : data[machine].isactivetime,
						'freezetime' : data[machine].freezetime,
						'logintime' : data[machine].logintime,
						'companyName' : data[machine].companyName,
						'remark' : data[machine].remark,
					} ];
					
					$('#dg').datagrid('loadData', { 'total':'30',rows:a });
					}
				},
				error : function() {
					alert('error');
				}
			});
 
			
		})
		 */
		
		
		$('#dg').datagrid({ 
		    width:'1077px',
			height:'450px',
			url:"/caocao/usermanage/query.do", 
			fitColumns:true,
			pagination:true,
			rownumbers:true,
			singleSelect:true,
			pageSize:10,
			
			columns:[[ 
				{field:'id',title:'id',width:'100',hidden:'true'}, 
				{field:'username',title:'姓名',width:'100'}, 
				{field:'phone',title:'手机号',width:'100'}, 
				{field:'post',title:'职位',width:'100',align:'right'} ,
				{field:'isactive',title:'是否启用',width:'100',align:'right'},
				{field:'isactivetime',title:'启用时间',width:'100',align:'right'},
				{field:'freezetime',title:'冻结时间',width:'100',align:'right'},
				{field:'logintime',title:'最近登录时间',width:'100',align:'right'},
				{field:'companyName',title:'所属公司',width:'100',align:'right'},
				{field:'remark',title:'备注',width:'100',align:'right'}
			]]
			
		});  

		
	});
</script>
<title>后台首页</title>
</head>

<body>
	

	<!--header start-->
    <div class="fn-title">
        <div class="navbar navBg">
        	<div class="navIcon">
            	
            </div>
            <div class="navUser">
            	<a href="login.html">退出</a>
                <span class="sx">|</span>
                <a href="userInfo.html">个人设置</a>
                <span class="topUserInfo_manage">欢迎您，管理员</span>
            </div>
        </div>
    </div>
    <!--header end-->
    <div class="container-fluid">
      <div class="row-fluid">
      	<!--菜单start-->
        <div class="leftArea">
         	  	<ul class="mainMenu">
            	<!--<li ><a href="javascript:void;" class="mainMenucls">系统设置</a>
                	<ul class="secondMenu">
                    	<li><a href="#" class="mainMenucls" >系统参数设置</a> </li>
                    </ul>
                </li>-->
                 <li class="mainMenu1 currentcls"><a  class="mainMenucls">用户管理</a>
                	<ul class="secondMenu">
                    	<li class="currentcls2"><em></em><a href="index.html">用户信息维护</a></li>
                    </ul>
                </li>
                
                <li class="mainMenu1"><a  class="mainMenucls">企业管理</a>
                	<ul class="secondMenu">
                    	<li><em></em><a href="vipCompanyService.html">大客户企业维护</a></li>
                        <li><em></em><a href="rentService.html">租赁公司维护</a></li>
                        <li><em></em><a href="labourService.html">劳务公司维护</a></li>
                    </ul>
                </li>
                <li class="mainMenu1" ><a class="mainMenucls">车辆管理</a>
                 	<ul class="secondMenu">
                    	<li><em></em><a href="carTypeSet.html">车型设置</a></li>
                    </ul>
                </li>
                <li class="mainMenu1" ><a class="mainMenucls">司机管理</a>
                	<ul class="secondMenu">
                    	<li><em></em><a href="driverService.html">司机培训合格维护</a></li>
                        <li><em></em><a href="driverWatch.html">司机信息查看</a></li>                    
                    </ul>
                </li>
                <li class="mainMenu1 "><a  class="mainMenucls">客户管理</a>
                	<ul class="secondMenu">
                    	<li><a class="mainMenucls">大客户管理</a>
                        	<ul class="thirdMenu">
                            	<li><em></em><a href="vipService.html">基本信息维护</a></li>
                                <li><em></em><a href="vipWatch.html">账户明细查看</a></li>
                            </ul>
                        </li>
                        <li><a class="mainMenucls ">普通客户管理</a>
                        	<ul class="thirdMenu">
                            	<li><em></em><a href="basicService.html">基本信息维护</a></li>
                                <li><em></em><a href="basicWatch.html">账户明细查看</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="mainMenu1"><a  class="mainMenucls">订单管理</a>
                	<ul class="secondMenu">
                    	<li><em></em><a href="bookingOrder.html">预约订单</a></li>
                        <li><em></em><a href="currentOrder.html">实时订单</a></li>
                        <li><em></em><a href="historyOrder.html">历史订单</a></li>
                    </ul>
                </li>
                <li class="mainMenu1" ><a  class="mainMenucls">推广管理</a>
                	<ul class="secondMenu">
                    	<li><em></em><a href="promotion.html">推广维护</a></li>                      
                    </ul>
                </li>
                <li class="mainMenu1"><a  class="mainMenucls">财务管理</a>
                	<ul class="secondMenu">
                    	<li><em></em><a href="vipIncome.html">大客户应收账款</a></li>
                        <li><em></em><a href="totalIncome.html">营业总收入</a></li>
                        <li><em></em><a href="platform.html">平台返利</a></li>
                        <li><em></em><a href="driverIncome.html">司机基本收入</a> </li>
                    </ul>
                </li>
            </ul>
        </div>
        <!--菜单end-->
        
         <!--Body content start-->
        <div class="rightArea">
        	<div class="mainCon">
              
               <h3>用户信息维护</h3>
               <div class="mainConcls">
               		<!--查询条件 start-->
               		<div class="mainConcls1 ">
                    	<div class="mainConcls2 clearfix">
                       		<label>姓名</label><input type="text" class="inputcls"   />
                            <label>手机号</label><input type="text" class="inputcls" />
                            <label>所属公司</label>
                             <select class="select " name="companyName" >
                                <option value="--请选择公司--" >--请选择公司--</option>
                                <option value="杭州优行科技有限公司" >杭州优行科技有限公司</option>
                            </select>
                            <input type="button" class="buttoncls" value="查询" id="search"/>
                        </div>     	
                    </div>
                    <!--查询条件end-->
                    
                    <!--内容 start-->
                    <div class="mainConcls4 clearfix">
                    	<a href="#" class="btn1"  onclick="newuser()">新增</a> 
                        <a href="#" class="btn1" onclick="edituser()">编辑</a> 
                    </div>
                    
                    <div class="mainConcls3"  >
                    	<table id="dg"></table>
                    </div>	
                    
                    <!--内容 end--> 
               </div> 
               
            </div>
        </div>
         <!--Body content end-->
      </div>
    </div>
    


	<div id="dlg" class="easyui-dialog" style="width: 700px; height: 365px; padding: 10px 20px;" closed="true" buttons="#dlg-buttons"> 
	   <div class="ftitle">信息编辑 </div> 
	   <form id="fm" method="post"> 
	   			<div class=" toastcls1 clearfix">
	                 <label>姓名</label>
	                 <input type="text" class="inputcls required"  required="true" name="username"  id="username"/>
	                 <label>手机号</label>
	                 <input type="text" class="inputcls required "  name="phone" id="phone" />
	             </div>
	             <div class="toastcls1 clearfix">
	                 <label>职位</label>
	                 <input type="text" class="inputcls required" name="post" id="post"/>
	                 <label>所属公司</label>
	                 <select class="select " name="companyName" id="companyName">
	                     <option  value="--请选择公司--" >--请选择公司--</option>
	                     <option value="10000" >杭州优行科技有限公司</option>
	                 </select>
	              </div>
	              <div class="toastcls1 clearfix" >
	                 <label>备注</label>
	                 <textarea class="textareacls" name="name" id="remark"></textarea>
	             </div>
	    </form> 
	</div>
	<div id="dlg-buttons"> 
	     <a href="javascript:void(0)" class="easyui-linkbutton" onclick="saveuser()" iconcls="icon-save">保存</a> 
		 <a href="javascript:void(0)" class="easyui-linkbutton" onclick="javascript:$('#dlg').dialog('close')" iconcls="icon-cancel">取消</a> 
	</div> 
    
 
</body>

    <script type="text/javascript">
        var url;
        var type;
        function newuser() {
            $("#dlg").dialog("open").dialog('setTitle', 'New User'); ;
            $("#fm").form("clear");
            url = "/caocao/usermanage/add.do";
        }
        function edituser() {
            var row = $("#dg").datagrid("getSelected");
          
            if (row) {
                $("#dlg").dialog("open").dialog('setTitle', 'Edit User');
                $("#fm").form("load", row);
                url = "/caocao/usermanage/update.do?id=" + row.id;
            }
        }
		
		function lookUser(){
			if (row){  
				 url = "UserManage.aspx?id=" + row.id;
			}  	
			
		}
		
		function saveuser(){  
			var username = $("#username").val(); //获取用户名称
			var phone = $("#phone").val(); //获取用户手机号
			var post = $("#post").val(); //获取用户职位
			var companyName =$("#companyName").val();//获取公司名称
			var remark = $("#remark").val(); //获取备注名称
			if(username==""){layer.msg("请输入姓名");return false;}
			if(phone==""||phone.length!=11){layer.msg("请输入正确的手机号");return false;}
			if(post==""){layer.msg("职位不能为空");return false;}
			if(companyName.indexOf("请选择公司")!=-1){layer.msg("请选择公司");return false;}
			
			var form = $("#fm").serialize();
		    $('#fm').form('submit',{  
		        url: url,  
		        data: form,
		        onSubmit: function(){  
		            return $(this).form('validate');  
		        },  
		        success: function(result){  
		        	if(result=="1"||result=="2"||result=="4"){
		        		layer.alert("网络异常,请重试")
		        	} else {  
		        		layer.alert("保存成功")
		                $('#dlg').dialog('close'); // close the dialog  
		                $('#dg').datagrid('reload'); // reload the user data  
		            }  
		        }  
		    });  
		}  
		
	
			   
		  
		     
	
    </script>

</html>
